# FilterMailandAct
This project is used to filter the mail based on some conditions and take specific actions

##Prerequisite :

To fetch the Google Oauth Token we need to follow certain steps:

1. Create your oauth client consent screen .Please refer this link(https://developers.google.com/identity/gsi/web/guides/get-google-api-clientid)

2. After creating your consent create the oauth client id and secret. Please refer to the following link(https://support.google.com/cloud/answer/6158849?hl=en)

Please copy the Client Id and Client Secret and Project Id.

3. After the client is created, an one time authentication code needs to be generated by hitting the following url.(Please change the values according to your config)


https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/gmail.readonly&access_type=offline&include_granted_scopes=true&response_type=code&
redirect_uri=<redirect_uri>&client_id=<client_id>&prompt=consent

This will generate a code in the below format:

https://www.google.com/?code=4/0AVG7fiSaLANydXithuFZiQ4xJ65LYpwmEHBwQbK4D6dJIiKXD33bon9bxRicqZqdDC5B5g&scope=https://www.googleapis.com/auth/gmail.readonly%20https://www.googleapis.com/auth/gmail.modify

Copy the code part alone in the above and store it (Sample: 4/0AVG7fiSaLANydXithuFZiQ4xJ65LYpwmEHBwQbK4D6dJIiKXD33bon9bxRicqZqdDC5B5g).


4. Now clone the project and you can find the sample_project.conf. you can either paste in the sample conf/you can use the different cnf and copy the content. 



##Detailed Description:

This project has contain 2 main scripts.

1. fetch mail and store : This script will read mail from the GMAIL using the googles oauth client and store it in the relational database. Additionally it also stores the labels(which is a kind of technical name for the GMAIL Folders) and store it in the database.

2. filter_and_take_action: This script will try to take the data generated by the previous script and validate against the set of rules(which has been stored in the json file). If the rule is matched, then it will update the GMAIL API to update the actions(The supported Actions are marking mail as read/un read or moving the mail to different folder.)


##Technical Specifications:

The project assumes that the system has already installed with python and the mysql. Following the versions that are compatible for the project.

Python - 3.9.1
MYSQL - 8.0.39


##How to run:

After forking the project, Need to create the virtual environment for the repo and then run the requirements.txt file.

Once the setup is done, Please run the following command:

python <your_folder_path>/scripts/fetch_mail_and_store.py --config-file <your config file path>

After the script is completed, Please run the following command:

python <your_folder_path>/scripts/filter_and_take_action.py --config-file <your config file path>

After the two scripts has been completed, a html file will be generated with latest time stamp which contains the latest details.



 
